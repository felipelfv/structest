# structest

[![R-CMD-CHECK](https://github.com/felipelfv/structest/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/felipelfv/structest/actions/workflows/R-CMD-check.yaml)
[![test-coverage](https://github.com/felipelfv/structest/actions/workflows/test-coverage.yaml/badge.svg)](https://github.com/felipelfv/structest/actions/workflows/test-coverage.yaml)
[![Lifecycle:
experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)

R package implementing the statistical tests from:

> VanderWeele, T. J. & Vansteelandt, S. (2022). A statistical test to
> reject the structural interpretation of a latent factor model.
> *Journal of the Royal Statistical Society: Series B (Statistical
> Methodology)*, 84, 2032–2054.
> [doi:10.1111/rssb.12555](https://doi.org/10.1111/rssb.12555)

## Background

Factor analysis is routinely used to assess whether a single univariate
latent variable explains the covariance among a set of observed
indicators. When a one-factor model fits adequately, researchers often
treat the latent variable as the causally relevant quantity in
subsequent analyses. This practice implicitly assumes a **structural**
interpretation of the latent factor model: that it is the latent
variable, rather than the individual indicators, that is causally
efficacious.

However, a measurement model fitting well does **not** imply the
structural interpretation is correct. The individual indicators could
each have separate causal effects on outcomes, even though their
covariance structure is consistent with a single latent factor (see
Figures 2 and 3 in the paper).

VanderWeele and Vansteelandt (2022) show that the structural
interpretation has empirically testable implications. Specifically,
under a structural latent factor model, the association between any
external variable *Z* and indicator *X_i*, scaled by the reliability of
*X_i*, must be the same across all indicators (Theorem 1). This package
implements the two statistical tests proposed in the paper:

- **T0**: a statistical test dependent on reliability estimates (Section
  3.2)
- **T1**: a statistical test independent of reliability estimates
  (Section 3.3)

**Note on terminology:** Following the paper, this package refers to the
coefficients *lambda_i* as “reliabilities.” In mainstream psychometrics
these are more commonly known as factor loadings.

## Installation

``` r
# Install from GitHub
devtools::install_github("felipelfv/structest")
```

## Functions

| Function                  | Description                                                                                                            |
|---------------------------|------------------------------------------------------------------------------------------------------------------------|
| `test_t0(X, z)`           | Statistical test dependent on reliability estimates (Section 3.2). Requires d \>= 3 indicators and p \>= 2 Z-levels.   |
| `test_t1(X, z)`           | Statistical test independent of reliability estimates (Section 3.3). Requires d \>= 2 indicators and p \>= 3 Z-levels. |
| `estimate_reliability(X)` | Estimation of reliability via quasi-Poisson GLM on pairwise covariances (Section 3.1).                                 |

## Code of Conduct

Please note that the structest project is released with a [Contributor
Code of
Conduct](https://felipelfv.github.io/structest/CODE_OF_CONDUCT.html). By
contributing to this project, you agree to abide by its terms.

## Reference

VanderWeele, T. J. & Vansteelandt, S. (2022). A statistical test to
reject the structural interpretation of a latent factor model. *Journal
of the Royal Statistical Society: Series B (Statistical Methodology)*,
84, 2032–2054.
[doi:10.1111/rssb.12555](https://doi.org/10.1111/rssb.12555)

# Package index

## All functions

- [`estimate_reliability()`](https://felipelfv.github.io/structest/reference/estimate_reliability.md)
  : Estimate Reliability Coefficients (Section 3.1)
- [`print(`*`<structest>`*`)`](https://felipelfv.github.io/structest/reference/print.structest.md)
  : Print method for structest objects
- [`structest`](https://felipelfv.github.io/structest/reference/structest-package.md)
  [`structest-package`](https://felipelfv.github.io/structest/reference/structest-package.md)
  : structest: Testing the Structural Interpretation of a Latent Factor
  Model
- [`summary(`*`<structest>`*`)`](https://felipelfv.github.io/structest/reference/summary.structest.md)
  : Summary method for structest objects
- [`test_t0()`](https://felipelfv.github.io/structest/reference/test_t0.md)
  : T0 Test: Reliability-Dependent Test of Structural Interpretation
  (Section 3.2)
- [`test_t1()`](https://felipelfv.github.io/structest/reference/test_t1.md)
  : T1 Test: Reliability-Independent Test of Structural Interpretation
  (Section 3.3)

# Articles

### All vignettes

- [The Factor Model as a Geometric
  Object](https://felipelfv.github.io/structest/articles/geometry.md):
- [Testing the Structural Interpretation of a Latent Factor
  Model](https://felipelfv.github.io/structest/articles/structest.md):
