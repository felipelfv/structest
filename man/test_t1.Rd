% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test_t1.R
\name{test_t1}
\alias{test_t1}
\title{T1 Test: Reliability-Independent Test of Structural Interpretation (Section 3.3)}
\usage{
test_t1(X, z, na.rm = TRUE, max_iter = 1000L, tol = 1e-25, verbose = FALSE)
}
\arguments{
\item{X}{numeric matrix (n x d) of indicator variables, d >= 3.}

\item{z}{numeric vector of length n encoding the auxiliary variable.
Must have at least 3 distinct levels.}

\item{na.rm}{logical; if \code{TRUE}, rows with any \code{NA} are removed.}

\item{max_iter}{integer; maximum iterations for the alternating LS procedure.}

\item{tol}{numeric; convergence tolerance for the alternating LS procedure.}

\item{verbose}{logical; if \code{TRUE}, print progress information.}
}
\value{
An object of class \code{c("structest_t1", "structest", "htest")}
containing:
\describe{
\item{statistic}{the T1 test statistic.}
\item{parameter}{degrees of freedom, \eqn{(d-1)(p-2)}.}
\item{p.value}{p-value from chi-squared distribution.}
\item{method}{description of the test.}
\item{data.name}{name of the data objects.}
\item{estimates}{list with \code{alpha} and \code{beta}.}
\item{n_obs}{number of observations used.}
\item{d}{number of indicators.}
\item{p}{number of Z-levels.}
\item{convergence}{convergence code from \code{nlm}.}
\item{optim_details}{full output from \code{nlm}.}
}
}
\description{
Tests whether the structural interpretation of a univariate latent factor
model can be rejected, without requiring estimation of reliability
coefficients. Uses centered indicators and a two-step efficient GMM procedure.
}
\details{
The indicators are centered by their row mean:
\eqn{X^c_{ik} = X_{ik} - \bar{X}_{i\cdot}}, which eliminates the latent
factor \eqn{Y}. Under the structural interpretation,
\eqn{E[X^c_i | Z = z_j] = \alpha_i \beta_j} where \eqn{\alpha_i} and
\eqn{\beta_j} are identifiable nuisance parameters. The test has
\eqn{(d-1)(p-2)} degrees of freedom. The full model (Equation 3 in the
paper) has \eqn{d \times p} moment conditions and \eqn{2d + p - 2} free
parameters (\eqn{d} intercepts, \eqn{d} alphas, \eqn{p-1} betas, minus 1
for the alpha-beta scale indeterminacy), giving
\eqn{dp - (2d+p-2) = (d-1)(p-2)} degrees of freedom.

The procedure uses a two-step efficient GMM: first with a fixed weight
matrix from initial estimates, then with the efficient weight matrix.
}
\references{
VanderWeele, T. J. and Vansteelandt, S. (2022). A statistical test to
reject the structural interpretation of a latent factor model.
\emph{Journal of the Royal Statistical Society Series B}, 84, 1063--1089.
}
