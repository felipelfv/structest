% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test_t0.R
\name{test_t0}
\alias{test_t0}
\title{T0 Test: Reliability-Dependent Test of Structural Interpretation (Section 3.2)}
\usage{
test_t0(X, z, na.rm = TRUE, max_iter = 1000L, verbose = FALSE)
}
\arguments{
\item{X}{numeric matrix (n x d) of indicator variables, d >= 3.}

\item{z}{numeric vector or factor of length n encoding a discrete auxiliary
variable. Must have at least 2 distinct levels. If \code{z} is continuous,
discretise it (e.g., into quantile groups) before use.}

\item{na.rm}{logical; if \code{TRUE}, rows with any \code{NA} are removed.}

\item{max_iter}{integer; maximum iterations for \code{nlm}.}

\item{verbose}{logical; if \code{TRUE}, print progress information.}
}
\value{
An object of class \code{c("structest_t0", "structest", "htest")}
containing:
\describe{
\item{statistic}{the T0 test statistic.}
\item{parameter}{degrees of freedom, \eqn{(d-1)(p-1)}.}
\item{p.value}{p-value from chi-squared distribution.}
\item{method}{description of the test.}
\item{data.name}{name of the data objects.}
\item{estimates}{list with \code{gamma} (intercepts), \code{beta} (Z effects),
and \code{lambda} (reliabilities).}
\item{n_obs}{number of observations used.}
\item{d}{number of indicators.}
\item{p}{number of Z-levels.}
\item{convergence}{convergence code from \code{nlm}.}
\item{optim_details}{full output from \code{nlm}.}
}
}
\description{
Tests whether the structural interpretation of a univariate latent factor
model can be rejected, using estimated reliability coefficients. The
variance of the estimating equations is adjusted for uncertainty in the
reliability estimates (see paper, p. 2041).
}
\details{
Under the structural model, \eqn{E[X_i | Z = z_j] = \gamma_i + (\lambda_i / \lambda_1) \beta_j}.
This gives \eqn{d \times p} moment conditions with \eqn{d + p - 1} free parameters
(\eqn{\gamma_1, \ldots, \gamma_d} and \eqn{\beta_2, \ldots, \beta_p} with \eqn{\beta_1 = 0}),
yielding \eqn{(d-1)(p-1)} degrees of freedom.

The variance of the estimating equations is adjusted for the
uncertainty in the reliability estimates \eqn{\lambda_i}
(see paper, p. 2041). Consistent generalised methods of moments
estimators (Newey & McFadden, 1994) are obtained by minimising
the resulting distance metric statistic.
}
\examples{
set.seed(12345)
n <- 1000
z <- rbinom(n, 1, 0.5)
eta <- 1 + 0.5 * z + rnorm(n)
lambda <- c(1.0, 0.8, 0.6)
X <- cbind(
  2 + lambda[1] * eta + rnorm(n, sd = 0.5),
  3 + lambda[2] * eta + rnorm(n, sd = 0.5),
  1 + lambda[3] * eta + rnorm(n, sd = 0.5)
)

result <- test_t0(X, z)
result

}
\references{
VanderWeele, T. J. and Vansteelandt, S. (2022). A statistical test to
reject the structural interpretation of a latent factor model.
\emph{Journal of the Royal Statistical Society: Series B (Statistical Methodology)}, 84, 2032--2054.
}
