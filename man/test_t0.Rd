% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test_t0.R
\name{test_t0}
\alias{test_t0}
\title{T0 Test: Reliability-Dependent Test of Structural Interpretation (Section 3.2)}
\usage{
test_t0(X, z, na.rm = TRUE, verbose = FALSE)
}
\arguments{
\item{X}{numeric matrix (n x d) of indicator variables, d >= 3.}

\item{z}{numeric vector of length n encoding the auxiliary variable.
Must have at least 2 distinct levels.}

\item{na.rm}{logical; if \code{TRUE}, rows with any \code{NA} are removed.}

\item{verbose}{logical; if \code{TRUE}, print progress information.}
}
\value{
An object of class \code{c("structest_t0", "structest", "htest")}
containing:
\describe{
\item{statistic}{the T0 test statistic.}
\item{parameter}{degrees of freedom, \eqn{(d-1)(p-1)}.}
\item{p.value}{p-value from chi-squared distribution.}
\item{method}{description of the test.}
\item{data.name}{name of the data objects.}
\item{estimates}{list with \code{gamma} (intercepts), \code{beta} (Z effects),
and \code{lambda} (reliabilities).}
\item{n_obs}{number of observations used.}
\item{d}{number of indicators.}
\item{p}{number of Z-levels.}
\item{convergence}{convergence code from \code{nlm}.}
\item{optim_details}{full output from \code{nlm}.}
}
}
\description{
Tests whether the structural interpretation of a univariate latent factor
model can be rejected, using a GMM test that accounts for uncertainty in
the estimated reliability coefficients.
}
\details{
Under the structural model, \eqn{E[X_i | Z = z_j] = \gamma_i + (\lambda_i / \lambda_1) \beta_j}.
This gives \eqn{d \times p} moment conditions with \eqn{d + p - 1} free parameters
(\eqn{\gamma_1, \ldots, \gamma_d} and \eqn{\beta_2, \ldots, \beta_p} with \eqn{\beta_1 = 0}),
yielding \eqn{(d-1)(p-1)} degrees of freedom.

The variance of the GMM estimating equations is adjusted for the
uncertainty in the reliability estimates \eqn{\lambda_i}.
}
\references{
VanderWeele, T. J. and Vansteelandt, S. (2022). A statistical test to
reject the structural interpretation of a latent factor model.
\emph{Journal of the Royal Statistical Society Series B}, 84, 2032--2054.
}
